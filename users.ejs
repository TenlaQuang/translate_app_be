<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - User Management</title>
  <style>
    /* Đảm bảo giao diện thích ứng với mọi kích thước màn hình */
body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
  margin: 0;
  padding: 30px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  height: 100vh;
  flex-direction: column;
}



/* Cải thiện bảng hiển thị người dùng */
table {
  width: 100%;
  margin-top: 20px;
  border-collapse: collapse;
  table-layout: fixed; /* Đảm bảo các cột có kích thước đều */
}

table, th, td {
  border: 1px solid #ddd;
}

th, td {
  padding: 12px;
  text-align: center;
  word-wrap: break-word;
}

/* Nút và hiệu ứng hover */
button {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
  transition: background-color 0.3s;
}

button:hover {
  background-color: #45a049;
}

/* Form thêm người dùng - popup */
.add-user-form {
  display: none;  /* Ẩn form */
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 999;
  width: 400px;  /* Đặt chiều rộng của popup */
  text-align: center;
}

.add-user-form.active {
  display: block;  /* Hiển thị form khi toggle */
}

.add-user-form input, .add-user-form button {
  margin-bottom: 10px;
  width: 100%;
}

/* Popup overlay */
.popup-overlay {
  display: none;  /* Ẩn overlay */
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5); /* Màu nền mờ */
  z-index: 998;
  justify-content: center;
  align-items: center;
}

/* Media Queries */
@media (max-width: 768px) {
  .container {
    width: 100%;
    padding: 10px;
  }

  table {
    font-size: 14px;
  }

  button {
    width: 100%;
    padding: 15px;
  }

  .add-user-form input, .add-user-form button {
    width: 100%;
  }
}

@media (max-width: 480px) {
  h1 {
    font-size: 24px;
  }

  button {
    font-size: 14px;
    padding: 12px;
  }

  table {
    font-size: 12px;
  }
}

  </style>
</head>
<body>
  <div class="container">
    <h1>User Management</h1>

    <!-- Button to navigate to chart page -->
    <button onclick="window.location.href='/chart'">View Translation Stats</button>

    <!-- Button to toggle add user form -->
    <br><br>
    <button onclick="toggleAddUserForm()">Add New User</button> <!-- Nút để toggle form thêm người dùng -->

    <!-- Popup form to add new user -->
    <div class="popup-overlay" id="popupOverlay" onclick="closePopup()">
      <div class="add-user-form" id="addUserForm" onclick="event.stopPropagation()">
        <button class="close-btn" onclick="closePopup()">×</button>  <!-- Nút đóng -->
        <h2>Add New User</h2>
        <form action="/add-user" method="POST">
          <input type="text" name="username" placeholder="Username" required><br>
          <input type="email" name="email" placeholder="Email" required><br>
          <input type="password" name="password" placeholder="Password" required><br>
          <button type="submit">Add User</button>
        </form>
      </div>
    </div>

    <h2>User List</h2>
    <table>
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Email</th>
        <th>Actions</th>
      </tr>
      <% users.forEach(user => { %>
        <tr>
          <td><%= user.user_id %></td>
          <td><%= user.username %></td>
          <td><%= user.email %></td>
          <td>
            <form action="/edit-user/<%= user.user_id %>" method="POST">
              <input type="text" name="username" value="<%= user.username %>" required>
              <input type="email" name="email" value="<%= user.email %>" required>
              <button type="submit">Update</button>
            </form>
            <a href="/delete-user/<%= user.user_id %>">Delete</a>
            <br>
            <a href="/history/<%= user.user_id %>">View Translation History</a>
          </td>
        </tr>
      <% }) %>
    </table>
  </div>

  <script>
    // Hiển thị form thêm người dùng khi bấm nút
    function toggleAddUserForm() {
      const form = document.getElementById('addUserForm');
      const overlay = document.getElementById('popupOverlay');
      form.classList.toggle('active');
      overlay.style.display = 'flex';  // Hiển thị overlay
    }

    // Đóng popup khi bấm nút đóng
    function closePopup() {
      const form = document.getElementById('addUserForm');
      const overlay = document.getElementById('popupOverlay');
      form.classList.remove('active');  // Ẩn form
      overlay.style.display = 'none';  // Ẩn overlay
    }
  </script>
</body>
</html>
